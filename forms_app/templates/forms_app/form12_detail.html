<!-- forms_app/templates/forms_app/form12_detail.html -->
{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>üìä –î–µ—Ç–∞–ª–∏ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É WB: {{ wb_article }}</h2>
        <div>
            <a href="{% url 'forms_app:form12_list' %}" class="btn btn-sm btn-secondary">
                ‚Üê –ù–∞–∑–∞–¥
            </a>
        </div>
    </div>

    <!-- –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π -->
    {% if messages %}
    <div class="messages mb-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show py-2" role="alert">
            <small>{{ message }}</small>
            <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ -->
    <div class="card mb-3">
        <div class="card-body py-2">
            <div class="row">
                <div class="col-md-6">
                    <medium><strong>–ê—Ä—Ç–∏–∫—É–ª WB:</strong> {{ wb_article }}</medium>
                </div>
                <div class="col-md-6">
                    <medium><strong>–ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞:</strong> {{ seller_article }}</medium>
                </div>
                <!-- –í –∫–∞—Ä—Ç–æ—á–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–≤–∞—Ä–µ -->
                <div class="col-md-4 text-end">
                    <a href="{% url 'forms_app:form12_delete_article' wb_article %}" class="btn btn-sm shadow-sm" style="background-color: #dc3545 !important; border-color: #dc3545 !important; color: white !important;">
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–∏–∫—É–ª
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É -->
    <div class="card mb-3">
        <div class="card-body py-2">
            <div class="row text-center">
                <div class="col">
                    <small class="text-muted d-block">üì¶ –ó–∞–∫–∞–∑—ã</small>
                    <strong class="text-primary">{{ total_orders }} —à—Ç.</strong>
                </div>
                <div class="col">
                    <small class="text-muted d-block">üí∞ –í—ã–∫—É–ø—ã</small>
                    <strong class="text-success">{{ total_sold }} —à—Ç.</strong>
                </div>
                <div class="col">
                    <small class="text-muted d-block">üí≥ –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ</small>
                    <strong class="text-warning">{{ total_transfer|floatformat:0 }} —Ä—É–±.</strong>
                </div>
                <div class="col">
                    <small class="text-muted d-block">üì¶ –û—Å—Ç–∞—Ç–æ–∫</small>
                    <strong class="text-info">{{ current_stock }} —à—Ç.</strong>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥—Ä–∞—Ñ–∏–∫–∞–º -->
    <div class="card mb-3">
        <div class="card-body py-2">
            <div class="d-flex justify-content-between align-items-center">
                <medium class="text-muted"><strong>üìà –ì—Ä–∞—Ñ–∏–∫–∏:</strong></medium>
                <div class="btn-group btn-group-sm" role="group">
                    <a href="{% url 'forms_app:form12_chart' wb_article 'orders' %}" class="btn btn-outline-primary" title="–ó–∞–∫–∞–∑—ã">
                        üì¶
                    </a>
                    <a href="{% url 'forms_app:form12_chart' wb_article 'sold' %}" class="btn btn-outline-success" title="–í—ã–∫—É–ø—ã">
                        üí∞
                    </a>
                    <a href="{% url 'forms_app:form12_chart' wb_article 'transfer' %}" class="btn btn-outline-warning" title="–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è">
                        üí≥
                    </a>
                    <a href="{% url 'forms_app:form12_chart' wb_article 'stock' %}" class="btn btn-outline-info" title="–û—Å—Ç–∞—Ç–∫–∏">
                        üìä
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö -->
    <div class="card">
        <div class="card-header py-2">
            <div class="d-flex justify-content-between align-items-center">
                <h6 class="mb-0">üìã –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</h6>
                <small class="text-muted">{{ records|length }} –∑–∞–ø–∏—Å–µ–π</small>
            </div>
        </div>
        <div class="card-body p-0">
            {% if records %}
            <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
                <table class="table table-sm table-striped table-hover mb-0">
                    <thead class="table-light sticky-top">
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–ë–∞—Ä–∫–æ–¥</th>
                            <th>–†–∞–∑–º–µ—Ä</th>
                            <th>–ó–∞–∫–∞–∑—ã</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–í—ã–∫—É–ø—ã</th>
                            <th>–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ</th>
                            <th>–û—Å—Ç–∞—Ç–æ–∫</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for record in records %}
                        <tr>
                            <td><small>{{ record.date|date:"d.m.Y" }}</small></td>
                            <td><small>{{ record.barcode|default:"‚Äî" }}</small></td>
                            <td><small>{{ record.size|default:"‚Äî" }}</small></td>
                            <td><small>{{ record.orders_qty|default:"‚Äî" }}</small></td>
                            <td><small>{{ record.order_amount_net|default:"‚Äî"|floatformat:0 }}</small></td>
                            <td><small>{{ record.sold_qty|default:"‚Äî" }}</small></td>
                            <td><small>{{ record.transfer_amount|default:"‚Äî"|floatformat:0 }}</small></td>
                            <td><small>{{ record.current_stock|default:"‚Äî" }}</small></td>
                            <td>
                                <div class="btn-group btn-group-sm" role="group">
                                    <a href="{% url 'forms_app:form12_edit' record.pk %}" class="btn btn-outline-primary" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                        ‚úèÔ∏è
                                    </a>
                                    <a href="{% url 'forms_app:form12_delete' record.pk %}" class="btn btn-outline-danger" title="–£–¥–∞–ª–∏—Ç—å">
                                        üóëÔ∏è
                                    </a>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="text-center py-4">
                <p class="text-muted mb-0">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.card-body.py-2 {
    padding-top: 0.5rem !important;
    padding-bottom: 0.5rem !important;
}

.card-header.py-2 {
    padding-top: 0.5rem !important;
    padding-bottom: 0.5rem !important;
}

.table-sm td,
.table-sm th {
    padding: 0.3rem 0.5rem;
    font-size: 0.875rem;
}

.btn-group-sm > .btn {
    padding: 0.2rem 0.4rem;
    font-size: 0.8rem;
}

.sticky-top {
    position: sticky;
    top: 0;
    z-index: 10;
    background-color: #f8f9fa;
}

/* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
.table-responsive::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}

.table-responsive::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
}

.table-responsive::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 3px;
}

.table-responsive::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
}

/* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã */
.alert.py-2 {
    padding-top: 0.4rem !important;
    padding-bottom: 0.4rem !important;
}

.btn-close-sm {
    padding: 0.5rem 0.5rem;
    background-size: 0.7em;
}
</style>
{% endblock %}