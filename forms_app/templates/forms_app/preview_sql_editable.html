<!-- templates/forms_app/preview_sql_editable.html -->

{% extends "base.html" %} {% block title %}‚úçÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤
(SQL){%endblock%} {% block content %}

<h2>üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤</h2>

<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ (GET) -->
<form method="get" style="display: inline-block; margin-right: 10px">
  <input
    type="text"
    name="q"
    placeholder="–ü–æ–∏—Å–∫ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É, —Ä–∞–∑–º–µ—Ä—É –∏–ª–∏ –º–µ—Å—Ç—É..."
    value="{{ request.GET.q }}"
    class="form-control"
    style="width: 300px"
  />
  <button type="submit" class="btn btn-info">üîé –ù–∞–π—Ç–∏</button>
</form>

<!-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (POST) -->
<form
  method="post"
  action="{% url 'forms_app:save_stock_sql' %}"
  style="display: inline-block"
>
  {% csrf_token %}

  <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ -->
  <input type="hidden" name="q" value="{{ request.GET.q|default:'' }}" />
  <input type="hidden" name="page" value="{{ page_obj.number }}" />

  <!-- –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –ø–µ—Ä–µ–¥ —Ç–∞–±–ª–∏—Ü–µ–π -->
  <button type="submit" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>

  <br /><br />

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π -->
  <div style="overflow-x: auto; border: 1px solid #ccc; padding: 10px">
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th
            style="
              position: sticky;
              top: 0;
              background-color: #f5f5f5;
              z-index: 2;
            "
          >
            –ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
          </th>
          <th
            style="
              position: sticky;
              top: 0;
              background-color: #f5f5f5;
              z-index: 2;
            "
          >
            –†–∞–∑–º–µ—Ä
          </th>
          <th
            style="
              position: sticky;
              top: 0;
              background-color: #f5f5f5;
              z-index: 2;
            "
          >
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
          </th>
          <th
            style="
              position: sticky;
              top: 0;
              background-color: #f5f5f5;
              z-index: 2;
            "
          >
            –ú–µ—Å—Ç–æ
          </th>
          <th
            style="
              position: sticky;
              top: 0;
              background-color: #f5f5f5;
              z-index: 2;
            "
          >
            –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
          </th>
        </tr>
      </thead>
      <tbody>
        {% if data %} {% for row in data %}
        <tr>
          <td>{{ row.article_full_name }}</td>
          <td>{{ row.size }}</td>
          <td>
            <input
              type="number"
              name="quantity_{{ row.id }}"
              value="{{ row.quantity }}"
              min="0"
              style="width: 80px"
            />
          </td>
          <td>
            <input
              type="text"
              name="location_{{ row.id }}"
              value="{{ row.location|default:'–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}"
              style="width: 100px"
            />
          </td>
          <td>
            <input
              type="text"
              name="note_{{ row.id }}"
              value="{{ row.note|default:'' }}"
              style="width: 200px"
            />
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" style="text-align: center; color: #999">
            ‚ùå –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
          </td>
        </tr>
        {% endfor %} {% endif %}
      </tbody>
    </table>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –ø–æ—Å–ª–µ —Ç–∞–±–ª–∏—Ü—ã (—É–¥–æ–±–Ω–æ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤) -->
  <button type="submit" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
</form>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
{% if is_paginated %}
<div class="pagination-container" style="margin-top: 20px; text-align: center">
  <span class="step-links">
    {% if page_obj.has_previous %}
    <a href="?q={{ request.GET.q|urlencode }}&page=1">&laquo; –ø–µ—Ä–≤–∞—è</a>
    <a
      href="?q={{ request.GET.q|urlencode }}&page={{ page_obj.previous_page_number }}"
    >
      &lsaquo; –ø—Ä–µ–¥—ã–¥—É—â–∞—è
    </a>
    {% endif %}

    <span class="current">
      –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
    <a
      href="?q={{ request.GET.q|urlencode }}&page={{ page_obj.next_page_number }}"
    >
      —Å–ª–µ–¥—É—é—â–∞—è &rsaquo;
    </a>
    <a href="?q={{ request.GET.q|urlencode }}&page={{ paginator.num_pages }}">
      –ø–æ—Å–ª–µ–¥–Ω—è—è &raquo;
    </a>
    {% endif %}
  </span>
</div>
{% endif %}

<br />
<a href="{% url 'forms_app:form6' %}" class="btn btn-primary"
  >‚¨ÖÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ñ–æ—Ä–º–µ 6</a
>

<!-- –°—Ç–∏–ª–∏ -->
<style>
  .table {
    width: 100%;
    border-collapse: collapse;
    white-space: nowrap;
  }
  .table th,
  .table td {
    padding: 8px;
    border: 1px solid #ddd;
  }
  .table th {
    position: sticky;
    top: 0;
    background-color: #f5f5f5;
    z-index: 2;
    box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.1);
  }
  .form-control {
    display: inline-block;
    width: 300px;
    padding: 6px 12px;
    font-size: 14px;
    color: #555;
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  .btn {
    display: inline-block;
    padding: 6px 12px;
    margin: 5px 0;
    font-size: 14px;
    font-weight: 400;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
    color: white;
    border: none;
    border-radius: 4px;
  }
  .btn:hover {
    opacity: 0.9;
  }
  .btn-success {
    background-color: #5cb85c;
  }
  .btn-info {
    background-color: #5bc0de;
  }
  .btn-primary {
    background-color: #337ab7;
  }
  .pagination-container a {
    margin: 0 10px;
    text-decoration: none;
    color: #007bff;
  }
  .pagination-container .current {
    font-weight: bold;
    color: #333;
  }
</style>

{% endblock %}
