<!-- forms_app/templates/forms_app/form10.html -->

{% extends "base.html" %} {% load static %} {% block title %}Форма 10 — Экспресс
анализ продаж{% endblock %} {% block content %}
<div class="container">
  <h2 class="mb-3 text-center">⚡ Форма 10 — Экспресс анализ продаж</h2>

  <div
    class="text-center mb-4 text-muted"
    style="font-size: 0.95em; line-height: 1.5"
  >
    <p class="mb-0">
      Загрузите <strong>отчёт по продажам и остаткам с Wildberries</strong> в
      формате <code>.xlsx</code>.
    </p>
    <p class="mb-0">
      Файл можно скачать в личном кабинете WB:
      <strong>Статистика → Отчёты → Продажи</strong>
    </p>
  </div>

  <!-- Форма загрузки -->
  <form
    method="post"
    enctype="multipart/form-data"
    class="border p-4 bg-white rounded shadow-sm"
  >
    {% csrf_token %}
    <div class="mb-3">
      <label for="excel_file" class="form-label">
        <i class="fas fa-file-excel"></i> Загрузите Excel-файл (формат .xlsx):
      </label>
      <input
        type="file"
        class="form-control"
        id="excel_file"
        name="excel_file"
        accept=".xlsx"
        required
      />
    </div>
    <button type="submit" class="btn btn-primary">
      <i class="fas fa-cogs"></i> Обработать файл
    </button>
  </form>

  <!-- Ошибка -->
  {% if error_message %}
  <div class="alert alert-danger mt-4">
    <i class="fas fa-exclamation-triangle"></i> {{ error_message }}
  </div>
  {% endif %}

  <!-- Результат в виде таблицы -->
  {% if table_html %}
  <h4 class="mt-5"><i class="fas fa-table"></i> Результат обработки</h4>
  <div class="table-responsive bg-white p-3 rounded shadow-sm border">
    {{ table_html|safe }}
  </div>

  <!-- Кнопка "Загрузить другой файл" -->
  <div class="mt-4">
    <a href="." class="btn btn-outline-primary">
      <i class="fas fa-undo"></i> Загрузить другой файл
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}
