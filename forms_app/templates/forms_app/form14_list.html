{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <div class="card">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h2 class="mb-0">üìä –§–æ—Ä–º–∞ 14: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º –∞—Ä—Ç–∏–∫—É–ª–∞–º</h2>
            <span class="badge bg-light text-dark">{{ records|length }} –¥–Ω–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ</span>
        </div>
        
        <div class="card-body">
            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="mb-4">
                <a href="{% url 'forms_app:form14_upload' %}" class="btn btn-primary">
                    <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                </a>
                <a href="{% url 'forms_app:form14_chart_default' %}" class="btn btn-success">
                    <i class="fas fa-chart-line"></i> –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏
                </a>
                <a href="{% url 'forms_app:form14_export' %}" class="btn btn-info">
                    <i class="fas fa-file-excel"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                </a>
                <a href="{% url 'forms_app:form14_clear' %}" class="btn btn-danger">
                    <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                </a>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
            <div class="card mb-4">
                <div class="card-body">
                    <h3>üìà –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –≥—Ä–∞—Ñ–∏–∫–∞–º:</h3>
                    <div class="btn-group" role="group">
                        <a href="{% url 'forms_app:form14_chart' 'orders' %}" class="btn btn-outline-primary">
                            üì¶ –ó–∞–∫–∞–∑—ã
                        </a>
                        <a href="{% url 'forms_app:form14_chart' 'order_amount' %}" class="btn btn-outline-primary">
                            üí∞ –°—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤
                        </a>
                        <a href="{% url 'forms_app:form14_chart' 'sold' %}" class="btn btn-outline-primary">
                            üõí –í—ã–∫—É–ø–ª–µ–Ω–æ
                        </a>
                        <a href="{% url 'forms_app:form14_chart' 'transfer' %}" class="btn btn-outline-primary">
                            üí∏ –ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é
                        </a>
                        <a href="{% url 'forms_app:form14_chart' 'stock' %}" class="btn btn-outline-primary">
                            üì¶ –û—Å—Ç–∞—Ç–æ–∫
                        </a>
                    </div>
                </div>
            </div>

          
            <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - —Ç–∞–±–ª–∏—á–Ω—ã–π –≤–∏–¥ -->
            {% if total_stats %}
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h3 class="mb-0">üìä –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
                </div>
                <div class="card-body p-2">
                    <table class="table table-borderless mb-0" style="table-layout: fixed;">
                        <tbody>
                            <tr>
                                <td class="text-center" style="width: 16.66%">
                                    <div class="p-2">
                                        <div class="text-primary mb-1">
                                            <i class="fas fa-shopping-cart fa-lg"></i>
                                        </div>
                                        <h5 class="mb-1">{{ total_stats.total_orders }}</h5>
                                        <small class="text-muted">–ó–∞–∫–∞–∑—ã, —à—Ç.</small>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 16.66%">
                                    <div class="p-2">
                                        <div class="text-success mb-1">
                                            <i class="fas fa-ruble-sign fa-lg"></i>
                                        </div>
                                        <h5 class="mb-1">{{ total_stats.total_order_amount|floatformat:0 }}</h5>
                                        <small class="text-muted">–°—É–º–º–∞, —Ä—É–±.</small>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 16.66%">
                                    <div class="p-2">
                                        <div class="text-info mb-1">
                                            <i class="fas fa-check-circle fa-lg"></i>
                                        </div>
                                        <h5 class="mb-1">{{ total_stats.total_sold }}</h5>
                                        <small class="text-muted">–í—ã–∫—É–ø–ª–µ–Ω–æ, —à—Ç.</small>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 16.66%">
                                    <div class="p-2">
                                        <div class="text-warning mb-1">
                                            <i class="fas fa-wallet fa-lg"></i>
                                        </div>
                                        <h5 class="mb-1">{{ total_stats.total_transfer|floatformat:0 }}</h5>
                                        <small class="text-muted">–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é</small>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 16.66%">
                                    <div class="p-2">
                                        <div class="text-secondary mb-1">
                                            <i class="fas fa-box fa-lg"></i>
                                        </div>
                                        <h5 class="mb-1">{{ total_stats.current_stock }}</h5>
                                        <small class="text-muted">–û—Å—Ç–∞—Ç–æ–∫, —à—Ç.</small>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 16.66%">
                                    <div class="p-2">
                                        <div class="text-danger mb-1">
                                            <i class="fas fa-calendar-day fa-lg"></i>
                                        </div>
                                        <h5 class="mb-1">{{ records|length }}</h5>
                                        <small class="text-muted">–î–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏</small>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}

            <!-- –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ -->
            <div class="card">
                <div class="card-header bg-light d-flex justify-content-between align-items-center">
                    <h3 class="mb-0">üìÖ –î–∞–Ω–Ω—ã–µ –ø–æ –¥–Ω—è–º</h3>
                    <a href="{% url 'forms_app:form14_delete_by_date' %}" class="btn btn-sm btn-outline-danger">
                        <i class="fas fa-calendar-times"></i> –£–¥–∞–ª–∏—Ç—å –ø–æ –¥–∞—Ç–µ
                    </a>
                </div>
                <div class="card-body">
                    {% if records %}
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–ó–∞–∫–∞–∑—ã, —à—Ç.</th>
                                    <th>–°—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤, —Ä—É–±.</th>
                                    <th>–í—ã–∫—É–ø–ª–µ–Ω–æ, —à—Ç.</th>
                                    <th>–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é, —Ä—É–±.</th>
                                    <th>–û—Å—Ç–∞—Ç–æ–∫, —à—Ç.</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for record in records %}
                                <tr>
                                    <td><strong>{{ record.date|date:"d.m.Y" }}</strong></td>
                                    <td>{{ record.total_orders_qty|default:"0" }}</td>
                                    <td>{{ record.total_order_amount_net|floatformat:0|default:"0" }}</td>
                                    <td>{{ record.total_sold_qty|default:"0" }}</td>
                                    <td>{{ record.total_transfer_amount|floatformat:0|default:"0" }}</td>
                                    <td>{{ record.total_current_stock|default:"0" }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-5">
                        <i class="fas fa-database fa-3x text-muted mb-3"></i>
                        <h5>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</h5>
                        <p class="text-muted">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏</p>
                        <a href="{% url 'forms_app:form14_upload' %}" class="btn btn-primary">
                            <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—ã–π –æ—Ç—á–µ—Ç
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="card-footer text-muted">
            <small>
                <i class="fas fa-info-circle"></i> –§–æ—Ä–º–∞ 14 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º—É –∫–∞–±–∏–Ω–µ—Ç—É –±–µ–∑ —Ä–∞–∑–±–∏–≤–∫–∏ –ø–æ –∞—Ä—Ç–∏–∫—É–ª–∞–º
            </small>
        </div>
    </div>
</div>
{% endblock %}