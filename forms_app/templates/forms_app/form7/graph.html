{% extends "base.html" %} {% block extra_head %}
<style>
  /* –¢–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ ‚Äî –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º main */
  main {
    max-width: none !important;
    margin: 20px 0 !important;
    padding: 0 10px !important;
    width: 100%;
  }
</style>
{% endblock %} {% block content %}
<h2>üìä 3D –≥—Ä–∞—Ñ–∏–∫ –¥–∏–Ω–∞–º–∏–∫–∏ –ø—Ä–∏–±—ã–ª–∏</h2>
<p class="text-muted">{{ debug_info }}</p>

<div id="chart" style="width: 100%; height: 800px"></div>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    try {
      const container = document.getElementById("chart");
      const graphData = JSON.parse("{{ graph_json|escapejs }}");

      console.log("Graph data:", graphData); // –û—Ç–ª–∞–¥–∫–∞

      if (!graphData || !graphData.data || graphData.data.length === 0) {
        throw new Error("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞");
      }

      Plotly.newPlot("chart", graphData.data, graphData.layout)
        .then(() => console.log("–ì—Ä–∞—Ñ–∏–∫ —É—Å–ø–µ—à–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω"))
        .catch((err) => {
          console.error("–û—à–∏–±–∫–∞ Plotly:", err);
          container.innerHTML = `
            <div class="alert alert-danger">
              –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞: ${err.message}
              <br><small>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π</small>
            </div>
          `;
        });
    } catch (e) {
      console.error("–û—à–∏–±–∫–∞:", e);
      document.getElementById("chart").innerHTML = `
        <div class="alert alert-danger">
          ${e.message}
          <br><small>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π</small>
        </div>
      `;
    }
  });
</script>

<a href="{% url 'forms_app:form7_upload' %}" class="btn btn-secondary mt-3">
  ‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –∑–∞–≥—Ä—É–∑–∫–µ
</a>
{% endblock %}
